import{_ as N}from"./FsQop50g.js";import{_ as L}from"./CfhkHOsh.js";import{V as q}from"./BNt0v21H.js";import{_ as B,k as M,f as O,j as b,q as h,G as T,K as j,c as a,a as s,B as I,b as p,g as R,F as _,r as x,h as r,t as u,w as g,L as Z,M as G,o as n,A as U,d as P}from"#entry";import"./dEyoA6Mq.js";import"./C7YCVWHz.js";import"./eowDyVTy.js";import"./BPax6AzT.js";import"./erPheUey.js";const Q="data:image/svg+xml,%3csvg%20width='24'%20height='21'%20viewBox='0%200%2024%2021'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M19.3846%2019.0809C20.2343%2019.0809%2020.9231%2018.4135%2020.9231%2017.5902V15.2052C20.9231%2014.7111%2021.3364%2014.3108%2021.8462%2014.3108C22.356%2014.3108%2022.7693%2014.7111%2022.7693%2015.2052V17.5902C22.7693%2019.4015%2021.254%2020.8697%2019.3846%2020.8697H16.9232C16.4133%2020.8697%2016%2020.4693%2016%2019.9754C16%2019.4813%2016.4133%2019.0809%2016.9232%2019.0809H19.3846Z'%20fill='%23E6F6FF'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M19.3846%201.78882C20.2343%201.78882%2020.9231%202.45622%2020.9231%203.2795V5.66459C20.9231%206.15856%2021.3364%206.559%2021.8462%206.559C22.356%206.559%2022.7693%206.15856%2022.7693%205.66459V3.2795C22.7693%201.46828%2021.254%200%2019.3846%200H16.9232C16.4133%200%2016%200.400441%2016%200.894412C16%201.38838%2016.4133%201.78882%2016.9232%201.78882H19.3846Z'%20fill='%23E6F6FF'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M4.61117%2019.0809C3.76151%2019.0809%203.07271%2018.4135%203.07271%2017.5902V15.2052C3.07271%2014.7111%202.65945%2014.3108%202.14964%2014.3108C1.63984%2014.3108%201.22656%2014.7111%201.22656%2015.2052V17.5902C1.22656%2019.4015%202.74191%2020.8697%204.61117%2020.8697H7.07272C7.58252%2020.8697%207.9958%2020.4693%207.9958%2019.9754C7.9958%2019.4813%207.58252%2019.0809%207.07272%2019.0809H4.61117Z'%20fill='%23E6F6FF'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M4.61117%201.78882C3.76151%201.78882%203.07271%202.45622%203.07271%203.2795V5.6646C3.07271%206.15856%202.65945%206.559%202.14964%206.559C1.63984%206.559%201.22656%206.15856%201.22656%205.6646V3.2795C1.22656%201.46829%202.74191%200%204.61117%200H7.07272C7.58252%200%207.9958%200.400441%207.9958%200.894412C7.9958%201.38838%207.58252%201.78882%207.07272%201.78882H4.61117Z'%20fill='%23E6F6FF'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M24%2010.4347C24%2010.9286%2023.5867%2011.329%2023.077%2011.329H0.923076C0.41328%2011.329%200%2010.9286%200%2010.4347C0%209.94075%200.41328%209.54028%200.923076%209.54028H23.077C23.5867%209.54028%2024%209.94075%2024%2010.4347Z'%20fill='%23E6F6FF'/%3e%3c/svg%3e",z=window.setInterval,J={class:"flex flex-col min-h-screen bg-gray-50/50"},K={class:"px-4 pb-20 sm:px-6 lg:px-8 max-w-5xl mx-auto w-full"},W={key:0,class:"mb-8"},X={class:"grid grid-cols-1 gap-4"},Y={class:"flex items-center justify-between"},ee={class:"text-md font-bold text-[#0F3F5E]"},te={class:"text-sm text-[#627D98]"},le=["onClick","disabled"],se={key:1},oe={class:"flex gap-2 mb-4 overflow-x-auto scrollbar-hide"},ne=["onClick"],ie={class:"flex items-center justify-between mb-4 ml-1"},ae={class:"text-sm font-semibold text-[#627D98] uppercase tracking-wider"},re={role:"list",class:"space-y-4"},ce={key:3,class:"h-full flex flex-col items-center justify-center"},de={key:0,class:"fixed bottom-20 right-5 sm:hidden"},ue={class:"flex items-center justify-center h-14 w-14 rounded-full bg-black text-white shadow-lg hover:bg-blue-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600"},pe=["src"],fe={__name:"index",async setup(ve){let f,w;const v=M().params.wallet,{data:i,pending:$,refresh:S,error:he}=([f,w]=O(()=>Z(`/wallet-api/wallet/${v}/credentials?showDeleted=false&showPending=false`,{dedupe:"defer"},"$N2s-0lSB2s")),f=await f,w(),f),c=b("all"),C=t=>{try{const e=typeof t.document=="string"?JSON.parse(t.document):t.document,o=e?.vc?.type||e?.type||[];return((Array.isArray(o)?o:[o]).at(-1)||"").toLowerCase().replace(/credential$|vc$/i,"")}catch{return"generic"}},F=h(()=>{if(!i.value)return[];const t={all:0,receipt:0,invoice:0,quote:0,other:0};return i.value.forEach(e=>{t.all++;const o=C(e);o.includes("receipt")||o.includes("payment")?t.receipt++:o.includes("invoice")?t.invoice++:o.includes("quote")?t.quote++:t.other++}),[{id:"all",label:"All",count:t.all},{id:"receipt",label:"Receipts",count:t.receipt},{id:"invoice",label:"Invoices",count:t.invoice},{id:"quote",label:"Quotes",count:t.quote}].filter(e=>e.count>0||e.id==="all")}),A=h(()=>!i.value||c.value==="all"?i.value:i.value.filter(t=>{const e=C(t);return c.value==="receipt"?e.includes("receipt")||e.includes("payment"):c.value==="invoice"?e.includes("invoice"):c.value==="quote"?e.includes("quote"):!0})),D=h(()=>F.value.find(e=>e.id===c.value)?.label||"My Saved Items");h(()=>i.value?i.value.find(t=>{try{const e=typeof t.document=="string"?JSON.parse(t.document):t.document;return e?.vc?.type?.includes("GenericID")||e?.type?.includes("GenericID")}catch{return!1}}):null);const d=b([]),m=b(null);let y=null;const k=async()=>{try{const t=await $fetch("/wallet-api/credentials/pending-offers",{credentials:"include"});d.value=t.offers||[]}catch(t){console.error("Failed to fetch pending offers:",t)}},H=async t=>{try{m.value=t.id,await $fetch("/wallet-api/credentials/accept-offer",{method:"POST",credentials:"include",body:{offerUri:t.offerUri}}),await S(),d.value=d.value.filter(e=>e.id!==t.id)}catch(e){console.error("Failed to accept offer:",e),alert("Failed to accept credential: "+e.message)}finally{m.value=null}};return T(()=>{k(),y=z(k,3e4)}),j(()=>{y&&clearInterval(y)}),(t,e)=>{const o=N,V=G("LoadingIndicator");return n(),a(_,null,[s("div",J,[p(L),s("div",K,[d.value&&d.value.length>0?(n(),a("div",W,[e[0]||(e[0]=s("h2",{class:"text-sm font-semibold text-[#627D98] uppercase tracking-wider mb-4 ml-1"},"Save to Wallet",-1)),s("div",X,[(n(!0),a(_,null,x(d.value,l=>(n(),a("div",{key:l.id,class:"rounded-xl p-4 shadow-md bg-white border border-blue-100"},[s("div",Y,[s("div",null,[s("h3",ee,u(l.credentialType),1),s("p",te,u(l.issuerName),1)]),s("button",{onClick:E=>H(l),disabled:m.value===l.id,class:"px-4 py-2 text-sm text-white font-medium rounded-lg shadow-sm hover:shadow transition-all",style:{background:"linear-gradient(135deg, #2188CA, #0F3F5E)"}},u(m.value===l.id?"...":"Save"),9,le)])]))),128))])])):I("",!0),r(i)&&r(i).length>0?(n(),a("div",se,[s("div",oe,[(n(!0),a(_,null,x(F.value,l=>(n(),a("button",{key:l.id,onClick:E=>c.value=l.id,class:U(["px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all",c.value===l.id?"bg-[#0F3F5E] text-white shadow-md":"bg-white text-[#627D98] border border-[#E4E7EB] hover:bg-[#F0F4F8]"])},u(l.label)+" ("+u(l.count)+") ",11,ne))),128))]),s("div",ie,[s("h2",ae,u(D.value),1)]),s("ul",re,[(n(!0),a(_,null,x(A.value,(l,E)=>(n(),a("li",{key:l.id,class:"transform hover:scale-[1.01] cursor-pointer duration-200"},[p(o,{to:`/wallet/${r(v)}/credentials/`+encodeURIComponent(l.id)},{default:g(()=>[p(q,{credential:l,isDetailView:!1},null,8,["credential"])]),_:2},1032,["to"])]))),128))])])):r($)?(n(),R(V,{key:2},{default:g(()=>[...e[1]||(e[1]=[P("Loading...",-1)])]),_:1})):(n(),a("div",ce,[e[3]||(e[3]=s("p",{class:"mt-2 text-md text-[#627D98]"}," No saved items yet ",-1)),p(o,{to:`/wallet/${r(v)}/scan`},{default:g(()=>[...e[2]||(e[2]=[s("button",{class:"mt-8 px-5 py-2.5 text-white rounded-xl shadow-lg hover:shadow-xl focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[#2188CA] transition-all",style:{background:"linear-gradient(135deg, #2188CA, #0F3F5E)"}}," Scan QR Code ",-1)])]),_:1},8,["to"])]))])]),r(i)&&r(i).length>0?(n(),a("div",de,[p(o,{to:`/wallet/${r(v)}/scan`},{default:g(()=>[s("button",ue,[s("img",{src:r(Q),alt:"Scan QR code",class:"h-6 w-6"},null,8,pe)])]),_:1},8,["to"])])):I("",!0)],64)}}},Ve=B(fe,[["__scopeId","data-v-d7824681"]]);export{Ve as default};
