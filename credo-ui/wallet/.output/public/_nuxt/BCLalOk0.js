import{d as U}from"./Drjdh8M5.js";import{u as j}from"./CbphGzgi.js";import{x as r,l as b,S as C,k as N,c as g,o as y,n as w,g as s,h,a as u,t as S}from"#entry";function O(e){const l=atob(e);return Uint8Array.from(l,t=>t.codePointAt(0))}function E(e){const l=String.fromCodePoint(...e);return btoa(l)}function V(e){return E(new TextEncoder().encode(e))}function A(e){return new TextDecoder().decode(O(e))}function J(e){try{return e.split("~").map(l=>JSON.parse(A(l)))}catch(l){return console.error("Error parsing disclosures:",l),[]}}function H(e){return V(JSON.stringify(e)).replaceAll("=","")}function $(e){var l=e.split(".")[1],t=l.replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(window.atob(t).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""));try{return JSON.parse(n)}catch{return n}}function z(e){const l=j(),t=U(async()=>{if(e.value){if(e.value.parsedDocument)return e.value.parsedDocument;let i;return e.value.format&&e.value.format==="mso_mdoc"?i=await(await fetch("/wallet-api/util/parseMDoc",{method:"POST",body:e.value.document})).json():i=$(e.value.document),i.vc?i.vc:i}else return null}),n=r(()=>e.value&&e.value.disclosures?J(e.value.disclosures):null),a=r(()=>e.value?.manifest&&e.value.manifest!="{}"?typeof e.value.manifest=="string"?JSON.parse(e.value.manifest):e.value.manifest:e.value?.parsedDocument?.display?.[0]??null),c=r(()=>a.value?.display?.claims);async function f(i){try{return(await(await fetch(`/wallet-api/wallet/${l.value}/exchange/resolveVctUrl?vct=${i}`)).json()).name||null}catch(x){return console.error("Error fetching VCT name:",x),null}}const v=b("");C(async()=>{if(t.value?.vct){const i=t.value.vct;v.value=await f(i)}else v.value=a.value?.display?.title??t.value?.type?.at(-1)?.replace(/([a-z0-9])([A-Z])/g,"$1 $2")??t.value?.vct?.replace("_vc+sd-jwt","").replace(/([a-z0-9])([A-Z])/g,"$1 $2")??t.value?.docType});const d=r(()=>a.value?.display?.card?.description??t.value?.name),m=r(()=>a.value?.display?.card?.logo?.uri??t.value?.issuer?.image?.id??t.value?.issuer?.image),o=r(()=>a.value?.display?.card?.issuedBy??t.value?.issuer?.name),D=r(()=>t.value?.issuer?.image?.id??t.value?.issuer?.image),p=r(()=>a.value?.input?.issuer??t.value?.issuer?.id??t.value?.issuer),_=r(()=>e.value.format==="vc+sd-jwt"?t.value?.iss??null:null),k=r(()=>a.value?.input?.credentialIssuer),I=r(()=>t.value?.expirationDate?new Date(t.value?.expirationDate).getTime()>new Date().getTime():t.value?.validUntil?new Date(t.value?.validUntil).getTime()>new Date().getTime():!0),T=r(()=>t.value?.issuanceDate?new Date(t.value?.issuanceDate).toISOString().slice(0,10):t.value?.validFrom?new Date(t.value?.validFrom).toISOString().slice(0,10):null),B=r(()=>t.value?.expirationDate?new Date(t.value?.expirationDate).toISOString().slice(0,10):t.value?.validUntil?new Date(t.value?.validUntil).toISOString().slice(0,10):null);return{jwtJson:t,disclosures:n,manifest:a,manifestClaims:c,titleTitelized:v,credentialSubtitle:d,credentialImageUrl:m,issuerName:o,issuerLogo:D,issuerDid:p,issuerKid:_,credentialIssuerService:k,isNotExpired:I,issuanceDate:T,expirationDate:B}}const P={key:0,class:"flex justify-end"},q={class:"mb-8"},F={class:"text-2xl font-bold bold"},L={class:"flex justify-between items-end gap-2"},W=["src"],Z={key:1,class:"font-mono mt-3"},Q=N({__name:"VerifiableCredentialCard",props:{credential:{type:Object,required:!0},showId:{type:Boolean,required:!1,default:!1},isDetailView:{type:Boolean,required:!1,default:!1}},setup(e){const l=e,{jwtJson:t,manifest:n,titleTitelized:a,isNotExpired:c,issuerName:f,issuerLogo:v}=z(b(l.credential)),d=r(()=>n.value?.display?.card??n.value),m=b(l.isDetailView??!1),o=b(null);return C(async()=>{try{o.value&&d.value&&(n.value.backgroundImage?(o.value.style.backgroundImage=`url(${n.value.backgroundImage.url})`,o.value.style.backgroundSize="cover",o.value.style.backgroundPosition="center"):d.value.backgroundColor&&(o.value.style.background=d.value.backgroundColor),d.value.textColor&&(o.value.style.color=d.value.textColor))}catch{}}),(D,p)=>(y(),g("div",{ref_key:"vcCardDiv",ref:o,class:w({"p-6 rounded-2xl shadow-2xl sm:shadow-lg h-full text-white":!0,"lg:w-[400px]":m.value,"bg-gradient-to-br from-[#0573F0] to-[#03449E] border-t-white border-t-[0.5px]":s(c),"bg-[#7B8794]":!s(c)})},[s(c)?h("",!0):(y(),g("div",P,[...p[0]||(p[0]=[u("div",{class:"text-black bg-[#CBD2D9] px-2 py-1 rounded-full text-xs"},"Expired",-1)])])),u("div",q,[u("div",F,S(m.value?s(a):s(a)?.length>20?s(a)?.slice(0,20)+"...":s(a)),1)]),u("div",{class:w({"sm:mt-18":s(c),"sm:mt-8":!s(c)})},[u("div",L,[u("div",null,[u("div",{class:w({"text-[#0573f000]":!s(f)})},"Issuer",2),u("div",{class:w([{"text-[#0573f000]":!s(f)},"font-bold"])},S(s(f)??"Unknown"),3)]),s(v)?(y(),g("img",{key:0,src:s(v),alt:"Issuer Logo",class:"h-6 rounded-full"},null,8,W)):h("",!0)])],2),e.showId?(y(),g("div",Z,"ID: "+S(s(t)?.id),1)):h("",!0)],2))}});export{Q as _,J as a,H as e,$ as p,z as u};
