var l=(t=>(t[t.PRESENTATION=0]="PRESENTATION",t[t.ISSUANCE=1]="ISSUANCE",t))(l||{});const u=new Map([["openid://",0],["openid4vp://",0],["mdoc-openid4vp://",0],["haip://",0],["openid-initiate-issuance://",1],["openid-credential-offer://",1]]);function n(t){return t.replaceAll(`
`,"").trim()}function o(t){return btoa(t).replaceAll("=","").replaceAll("+","-").replaceAll("/","_")}function p(t){if(!t||typeof t!="string")return t;const e=t.trim(),i=e.startsWith("http://")||e.startsWith("https://"),r=e.startsWith("openid-")||e.startsWith("openid://")||e.startsWith("openid4vp://")||e.startsWith("openid-initiate-issuance://"),a=e.startsWith("{")||e.startsWith("[");if(i||r||a||e.includes("credential_offer_uri")||e.includes("issuanceRequests")||e.includes("presentationRequests"))return e;try{let s=e.replace(/-/g,"+").replace(/_/g,"/");for(;s.length%4!==0;)s+="=";return atob(s)}catch(s){return console.warn("[siop] decodeRequest: base64 decode failed, returning original string",s,t),e}}function d(t){return c(n(t))!=null}function c(t){t=n(t);for(let[e,i]of u)if(t.startsWith(e))return i;if(t.includes("presentationRequests"))return 0;if(t.includes("issuanceRequests")||t.includes("credential_offer_uri")||t.includes("credential_offer")||t.includes("credential_issuer")||t.includes('"credentials"')||t.includes("'credentials'")||t.startsWith("http://")||t.startsWith("https://"))return 1;if(t.trim().startsWith("{")||t.trim().startsWith("["))try{const e=JSON.parse(t);if(e.credential_issuer||e.credentials||e.grants)return 1}catch{}return null}export{l as S,p as d,o as e,n as f,c as g,d as i};
