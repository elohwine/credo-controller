console.log("walt.id wallet service worker run");self.addEventListener("install",()=>{console.log("Service worker installing")});self.addEventListener("push",function(t){console.log("Push message received."),console.log(t.data.json());let i="Hello";const e={body:"Thanks for sending this push msg.",data:{url:"https://docs.walt.id/v/web-wallet/wallet-kit/readme"},actions:[{action:"accept-action",type:"button",title:"✅ Accept"},{action:"reject-action",type:"button",title:"❌ Reject"}]};if(t.data){const o=t.data.json();i=o.title,e.body=o.body;const a=btoa(o.action).replaceAll("=","");o.type==="issuance"?e.data.url="http://localhost:3000/exchange/issuance?request="+a:o.type==="verification"&&(e.data.url="http://localhost:3000/exchange/presentation?request="+a)}t.waitUntil(self.registration.showNotification(i,e))});self.addEventListener("notificationclick",function(t){console.log("Notification clicked."),t.notification.close();let i=Promise.resolve();if(t.action==="accept-action")i=clients.openWindow(t.notification.data.url+"&accept=true");else{if(t.action==="reject-action")return;t.notification.data&&t.notification.data.url&&(i=clients.openWindow(t.notification.data.url))}t.waitUntil(i)});
